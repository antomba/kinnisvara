---
layout: default
---

<article class="section" itemscope itemtype="https://schema.org/BlogPosting">
  <header>
    <h1 itemprop="headline">{{ page.title }}</h1>
    {% assign words = content | number_of_words %}
    {% assign minutes = words | divided_by: 200 %}
    {% assign remainder = words | modulo: 200 %}
    {% if remainder > 0 %}
      {% assign minutes = minutes | plus: 1 %}
    {% endif %}
    {% if minutes < 1 %}
      {% assign minutes = 1 %}
    {% endif %}

    <ul class="meta-list">
      <li><time datetime="{{ page.date | date_to_xmlschema }}">{{ page.date | date: "%d.%m.%Y" }}</time></li>
      <li>{{ minutes }} min lugemist</li>
      {% if page.categories %}<li>Kategooriad: {{ page.categories | join: ", " }}</li>{% endif %}
      {% if page.tags %}<li>Sildid: {{ page.tags | join: ", " }}</li>{% endif %}
    </ul>

    <div class="taxonomy-links">
      {% for category in page.categories %}
        <a class="badge" href="{{ '/kategooriad/' | relative_url }}#{{ category | slugify }}">{{ category }}</a>
      {% endfor %}
      {% for tag in page.tags %}
        <a class="badge" href="{{ '/sildid/' | relative_url }}#{{ tag | slugify }}">#{{ tag }}</a>
      {% endfor %}
    </div>
  </header>

  <div itemprop="articleBody">
    {{ content }}
  </div>
</article>

<section class="section">
  <h2>Seotud postitused</h2>
  {% assign related_count = 0 %}
  <ul class="post-list">
    {% for post in site.posts %}
      {% if post.url != page.url %}
        {% assign shared_tags = 0 %}
        {% for tag in post.tags %}
          {% if page.tags contains tag %}
            {% assign shared_tags = shared_tags | plus: 1 %}
          {% endif %}
        {% endfor %}

        {% assign shared_cats = 0 %}
        {% for category in post.categories %}
          {% if page.categories contains category %}
            {% assign shared_cats = shared_cats | plus: 1 %}
          {% endif %}
        {% endfor %}

        {% assign relevance = shared_tags | plus: shared_cats %}
        {% if relevance > 0 and related_count < 3 %}
          {% assign related_count = related_count | plus: 1 %}
          <li class="post-card">
            <h3><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
            <p class="post-meta">{{ post.description }}</p>
          </li>
        {% endif %}
      {% endif %}
    {% endfor %}
  </ul>
  {% if related_count == 0 %}
    <p>Seotud postitused lisanduvad peagi.</p>
  {% endif %}
</section>
